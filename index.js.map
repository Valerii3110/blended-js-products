{"version":3,"file":"index.js","sources":["../src/home.js"],"sourcesContent":["import { refs } from './js/refs.js';\nimport {\n  fetchCategories,\n  fetchProducts,\n  fetchProductsByCategory,\n  searchProducts,\n} from './js/products-api.js';\nimport {\n  initPageTheme,\n  renderCategories,\n  renderProducts,\n} from './js/render-functions.js';\nimport { openModal } from './js/modal.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet currentPage = 1;\nlet currentCategory = 'All';\nlet currentSearchQuery = '';\nconst productsPerPage = 12;\n\n// Функції для роботи з loader\nconst showLoader = () => refs.loader?.classList.add('loader--visible');\nconst hideLoader = () => refs.loader?.classList.remove('loader--visible');\n\n// Функції для сповіщень\nconst showErrorToast = message => {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n};\n\nconst showNotFound = () => {\n  refs.products.innerHTML = '';\n  refs.notFound.classList.add('not-found--visible');\n  refs.loadMoreBtn.classList.add('is-hidden');\n};\n\nasync function loadProducts() {\n  try {\n    showLoader();\n    refs.products.innerHTML = '';\n    refs.notFound.classList.remove('not-found--visible');\n\n    let result;\n    if (currentSearchQuery) {\n      result = await searchProducts(currentSearchQuery);\n    } else if (currentCategory === 'All') {\n      result = await fetchProducts(\n        productsPerPage,\n        (currentPage - 1) * productsPerPage\n      );\n    } else {\n      result = await fetchProductsByCategory(\n        currentCategory,\n        productsPerPage,\n        (currentPage - 1) * productsPerPage\n      );\n    }\n\n    if (result.products.length === 0) {\n      showNotFound();\n    } else {\n      refs.products.innerHTML = renderProducts(result.products);\n      refs.loadMoreBtn.classList.toggle(\n        'is-hidden',\n        result.products.length < productsPerPage\n      );\n    }\n  } catch (error) {\n    console.error('Error loading products:', error);\n    showErrorToast('Failed to load products');\n    showNotFound();\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function loadMoreProducts() {\n  try {\n    showLoader();\n    let result;\n    if (currentSearchQuery) {\n      result = await searchProducts(currentSearchQuery);\n    } else if (currentCategory === 'All') {\n      result = await fetchProducts(\n        productsPerPage,\n        (currentPage - 1) * productsPerPage\n      );\n    } else {\n      result = await fetchProductsByCategory(\n        currentCategory,\n        productsPerPage,\n        (currentPage - 1) * productsPerPage\n      );\n    }\n\n    const newProducts = result.products;\n    if (newProducts.length > 0) {\n      refs.products.insertAdjacentHTML(\n        'beforeend',\n        renderProducts(newProducts)\n      );\n      if (newProducts.length < productsPerPage) {\n        refs.loadMoreBtn.classList.add('is-hidden');\n      }\n    } else {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      showErrorToast('No more products to load');\n    }\n  } catch (error) {\n    console.error('Error loading more products:', error);\n    showErrorToast('Failed to load more products');\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction setupEventListeners() {\n  // Category click\n  refs.categories.addEventListener('click', e => {\n    if (e.target.classList.contains('categories__btn')) {\n      const category = e.target.textContent.trim();\n      if (category !== currentCategory) {\n        currentCategory = category;\n        currentPage = 1;\n        currentSearchQuery = '';\n        refs.searchFormInput.value = '';\n        loadProducts();\n\n        // Update active category\n        document.querySelectorAll('.categories__btn').forEach(btn => {\n          btn.classList.remove('categories__btn--active');\n        });\n        e.target.classList.add('categories__btn--active');\n      }\n    }\n  });\n\n  // Product click\n  refs.products.addEventListener('click', e => {\n    const productItem = e.target.closest('.products__item');\n    if (productItem) {\n      const productId = productItem.dataset.id;\n      openModal(productId);\n    }\n  });\n\n  // Search form submit\n  refs.searchForm.addEventListener('submit', e => {\n    e.preventDefault();\n    const searchValue = refs.searchFormInput.value.trim();\n    if (searchValue) {\n      currentSearchQuery = searchValue;\n      currentPage = 1;\n      loadProducts();\n    }\n  });\n\n  // Clear search button\n  refs.searchFormClearBtn.addEventListener('click', () => {\n    refs.searchFormInput.value = '';\n    currentSearchQuery = '';\n    currentPage = 1;\n    loadProducts();\n  });\n\n  // Load more button\n  refs.loadMoreBtn.addEventListener('click', async () => {\n    currentPage += 1;\n    try {\n      showLoader();\n      let result;\n\n      if (currentSearchQuery) {\n        result = await searchProducts(currentSearchQuery);\n      } else if (currentCategory === 'All') {\n        result = await fetchProducts(\n          productsPerPage,\n          (currentPage - 1) * productsPerPage\n        );\n      } else {\n        result = await fetchProductsByCategory(\n          currentCategory,\n          productsPerPage,\n          (currentPage - 1) * productsPerPage\n        );\n      }\n\n      const newProducts = result.products;\n      if (newProducts.length > 0) {\n        refs.products.insertAdjacentHTML(\n          'beforeend',\n          renderProducts(newProducts)\n        );\n        if (newProducts.length < productsPerPage) {\n          refs.loadMoreBtn.classList.add('is-hidden');\n        }\n      } else {\n        refs.loadMoreBtn.classList.add('is-hidden');\n        showErrorToast('No more products to load');\n      }\n    } catch (error) {\n      console.error('Error loading more products:', error);\n      showErrorToast('Failed to load more products');\n    } finally {\n      hideLoader();\n    }\n  });\n\n  // Scroll to top button\n  refs.scrollTopBtn.addEventListener('click', () => {\n    window.scrollTo({\n      top: 0,\n      behavior: 'smooth',\n    });\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  try {\n    initPageTheme();\n    showLoader();\n    const categories = await fetchCategories();\n    refs.categories.innerHTML = renderCategories(['All', ...categories]);\n    await loadProducts();\n    setupEventListeners(); // Додаємо виклик функції\n  } catch (error) {\n    console.error('Initialization error:', error);\n    showErrorToast('Failed to initialize');\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["currentPage","currentCategory","currentSearchQuery","productsPerPage","showLoader","_a","refs","hideLoader","showErrorToast","message","iziToast","showNotFound","loadProducts","result","searchProducts","fetchProducts","fetchProductsByCategory","renderProducts","error","setupEventListeners","category","btn","productItem","productId","openModal","searchValue","newProducts","initPageTheme","categories","fetchCategories","renderCategories"],"mappings":"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"}