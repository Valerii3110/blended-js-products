import{i as I}from"./vendor-I1I71QQ2.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const y of c.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&s(y)}).observe(document,{childList:!0,subtree:!0});function o(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(r){if(r.ep)return;r.ep=!0;const c=o(r);fetch(r.href,c)}})();const p={PRODUCTS:"https://dummyjson.com/products",PRODUCT_BY_ID:"https://dummyjson.com/products/",SEARCH:"https://dummyjson.com/products/search",CATEGORIES:"https://dummyjson.com/products/categories",CATEGORY:"https://dummyjson.com/products/category/"},i={CART:"cart",WISHLIST:"wishlist",THEME:"theme"},u={LIMIT:12,INITIAL_PAGE:1},n={PRODUCTS_LIST:".products",CATEGORIES_LIST:".categories",MODAL:".modal",MODAL_PRODUCT:".modal-product",NOT_FOUND:".not-found",LOAD_MORE:".load-more",SEARCH_FORM:".search-form",SEARCH_INPUT:".search-form__input",SEARCH_CLEAR:".search-form__btn-clear",CART_COUNT:"[data-cart-count]",WISHLIST_COUNT:"[data-wishlist-count]",THEME_TOGGLE:".theme-toggle-btn"},a={productsList:document.querySelector(n.PRODUCTS_LIST),categoriesList:document.querySelector(n.CATEGORIES_LIST),modal:document.querySelector(n.MODAL),modalProduct:document.querySelector(n.MODAL_PRODUCT),notFound:document.querySelector(n.NOT_FOUND),loadMoreBtn:document.querySelector(n.LOAD_MORE),searchForm:document.querySelector(n.SEARCH_FORM),searchInput:document.querySelector(n.SEARCH_INPUT),searchClearBtn:document.querySelector(n.SEARCH_CLEAR),cartCount:document.querySelector(n.CART_COUNT),wishlistCount:document.querySelector(n.WISHLIST_COUNT),themeToggle:document.querySelector(n.THEME_TOGGLE)};console.log("Refs:",a);const h=()=>{const t=document.createElement("div");t.className="loader",document.body.appendChild(t)},_=()=>{const t=document.querySelector(".loader");t&&t.remove()},f=t=>{I.error({title:"Error",message:t,position:"topRight"})},l=t=>{I.success({title:"Success",message:t,position:"topRight"})},$=(t,e)=>{let o;return(...s)=>{clearTimeout(o),o=setTimeout(()=>t.apply(void 0,s),e)}},P=async(t=u.INITIAL_PAGE,e=u.LIMIT)=>{try{h();const o=(t-1)*e,s=await fetch(`${p.PRODUCTS}?limit=${e}&skip=${o}`);if(!s.ok)throw new Error("Failed to fetch products");return await s.json()}catch(o){return f(o.message),{products:[],total:0}}finally{_()}},M=async t=>{try{h();const e=await fetch(`${p.PRODUCT_BY_ID}${t}`);if(!e.ok)throw new Error("Failed to fetch product");return await e.json()}catch(e){return f(e.message),null}finally{_()}},L=async(t,e=u.INITIAL_PAGE,o=u.LIMIT)=>{try{h();const s=(e-1)*o,r=t==="All"?`${p.PRODUCTS}?limit=${o}&skip=${s}`:`${p.CATEGORY}${t}?limit=${o}&skip=${s}`,c=await fetch(r);if(!c.ok)throw new Error("Failed to fetch products by category");return await c.json()}catch(s){return f(s.message),{products:[],total:0}}finally{_()}},W=async()=>{try{h();const t=await fetch("https://dummyjson.com/products/categories");if(!t.ok)throw new Error("Failed to fetch categories");return["All",...(await t.json()).map(s=>typeof s=="object"?s.name:s)]}catch(t){return f(t.message),["All"]}finally{_()}},E=async(t,e=u.INITIAL_PAGE,o=u.LIMIT)=>{try{if(!t.trim())return{products:[],total:0};h();const s=(e-1)*o,r=await fetch(`${p.SEARCH}?q=${t}&limit=${o}&skip=${s}`);if(!r.ok)throw new Error("Failed to search products");return await r.json()}catch(s){return f(s.message),{products:[],total:0}}finally{_()}},C=t=>{if(!t||t.length===0){a.productsList.innerHTML="",a.notFound.classList.add("not-found--visible"),a.loadMoreBtn.style.display="none";return}a.notFound.classList.remove("not-found--visible");const e=t.map(o=>`
    <li class="products__item" data-id="${o.id}">
      <img class="products__image" src="${o.thumbnail}" alt="${o.title}" loading="lazy"/>
      <p class="products__title">${o.title}</p>
      <p class="products__brand"><span class="products__brand--bold">Brand:</span> ${o.brand}</p>
      <p class="products__category">Category: ${o.category}</p>
      <p class="products__price">Price: $${o.price}</p>
    </li>
  `).join("");a.productsList.innerHTML=e},N=t=>{const e=t.map(o=>`
    <li class="products__item" data-id="${o.id}">
      <img class="products__image" src="${o.thumbnail}" alt="${o.title}" loading="lazy"/>
      <p class="products__title">${o.title}</p>
      <p class="products__brand"><span class="products__brand--bold">Brand:</span> ${o.brand}</p>
      <p class="products__category">Category: ${o.category}</p>
      <p class="products__price">Price: $${o.price}</p>
    </li>
  `).join("");a.productsList.insertAdjacentHTML("beforeend",e)},j=t=>{const e=t.map(o=>`
    <li class="categories__item">
      <button class="categories__btn" type="button" data-category="${o}">${o}</button>
    </li>
  `).join("");a.categoriesList.innerHTML=e},H=t=>{var r;const e=getFromStorage(STORAGE_KEYS.CART).includes(t.id),o=getFromStorage(STORAGE_KEYS.WISHLIST).includes(t.id),s=`
    <img class="modal-product__img" src="${t.thumbnail}" alt="${t.title}" />
    <div class="modal-product__content">
      <p class="modal-product__title">${t.title}</p>
      <ul class="modal-product__tags">
        ${((r=t.tags)==null?void 0:r.map(c=>`<li>${c}</li>`).join(""))||""}
      </ul>
      <p class="modal-product__description">${t.description}</p>
      <p class="modal-product__price">Price: $${t.price}</p>
      <div class="modal-product__buttons">
        <button class="modal-product__wishlist-btn" type="button" data-id="${t.id}">
          ${o?"Remove from Wishlist":"Add to Wishlist"}
        </button>
        <button class="modal-product__cart-btn" type="button" data-id="${t.id}">
          ${e?"Remove from Cart":"Add to Cart"}
        </button>
      </div>
    </div>
  `;a.modalProduct.innerHTML=s};let d=1,A="All",g="",S=!1;const R=()=>{const t=m(i.CART),e=document.querySelector(n.CART_COUNT);e&&(e.textContent=t.length,e.classList.add("nav__count--updated"),setTimeout(()=>{e.classList.remove("nav__count--updated")},300))},O=()=>{const t=m(i.WISHLIST),e=document.querySelector(n.WISHLIST_COUNT);e&&(e.textContent=t.length,e.classList.add("nav__count--updated"),setTimeout(()=>{e.classList.remove("nav__count--updated")},300))},B=async t=>{if(!t.target.classList.contains("categories__btn"))return;const e=t.target.dataset.category;A=e,d=1,document.querySelectorAll(".categories__btn").forEach(s=>{s.classList.remove("categories__btn--active")}),t.target.classList.add("categories__btn--active");const{products:o}=await L(e,d);C(o)},x=async t=>{const e=t.target.closest(".products__item");if(!e)return;const o=e.dataset.id,s=await M(o);s&&F(s)},Y=async()=>{if(S)return;S=!0,d+=1;let t=[];g?t=(await E(g,d)).products:t=(await L(A,d)).products,t.length>0?N(t):a.loadMoreBtn.style.display="none",S=!1},K=$(async t=>{t.preventDefault();const e=a.searchInput.value.trim();if(!e)return;g=e,d=1;const{products:o}=await E(e,d);C(o),a.loadMoreBtn.style.display=o.length>=PAGINATION.LIMIT?"block":"none"},500),z=()=>{a.searchInput.value="",g="",d=1,P(d).then(({products:t})=>{C(t),a.loadMoreBtn.style.display=t.length>=PAGINATION.LIMIT?"block":"none"})},J=()=>{window.scrollTo({top:0,behavior:"smooth"})},Q=()=>{const e=(localStorage.getItem("theme")||"light")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)},m=t=>{const e=localStorage.getItem(t);return e?JSON.parse(e):[]},T=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},k=t=>{const e=m(i.CART);e.includes(t)||(e.push(t),T(i.CART,e),R(),l("Product added to cart"))},D=t=>{const o=m(i.CART).filter(s=>s!==t);T(i.CART,o),R(),l("Product removed from cart")},q=t=>{const e=m(i.WISHLIST);e.includes(t)||(e.push(t),T(i.WISHLIST,e),O(),l("Product added to wishlist"))},U=t=>{const o=m(i.WISHLIST).filter(s=>s!==t);T(i.WISHLIST,o),O(),l("Product removed from wishlist")},V=()=>{const t=localStorage.getItem(i.THEME)||"light";return document.documentElement.setAttribute("data-theme",t),t},w=t=>{t.code==="Escape"&&v()},b=t=>{t.target===a.modal&&v()},F=t=>{H(t),a.modal.classList.add("modal--is-open"),document.body.style.overflow="hidden",document.addEventListener("keydown",w),a.modal.addEventListener("click",b);const e=a.modal.querySelector(".modal-product__wishlist-btn"),o=a.modal.querySelector(".modal-product__cart-btn");e.addEventListener("click",()=>{const s=e.dataset.id;e.textContent.includes("Remove")?(U(s),e.textContent="Add to Wishlist",l("Removed from wishlist")):(q(s),e.textContent="Remove from Wishlist",l("Added to wishlist"))}),o.addEventListener("click",()=>{const s=o.dataset.id;o.textContent.includes("Remove")?(D(s),o.textContent="Add to Cart",l("Removed from cart")):(k(s),o.textContent="Remove from Cart",l("Added to cart"))})},v=()=>{a.modal.classList.remove("modal--is-open"),document.body.style.overflow="",document.removeEventListener("keydown",w),a.modal.removeEventListener("click",b)};export{O as a,W as b,a as c,j as d,P as e,M as f,m as g,B as h,V as i,x as j,Y as k,K as l,z as m,Q as n,J as o,C as r,R as u};
//# sourceMappingURL=modal-Cf-3TiyZ.js.map
